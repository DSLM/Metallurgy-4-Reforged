/*==============================================================================
 = Class: test
 = This class is part of Metallurgy 4: Reforged
 = Complete source code is available at https://github.com/Davoleo/Metallurgy-4-Reforged
 = This code is licensed under GNU GPLv3
 = Authors: Davoleo, ItHurtsLikeHell, PierKnight100
 = Copyright (c) 2018-2021.
 =============================================================================*/

tasks.register("testServer", { task ->
    description = 'Tests the server startup'
    group = 'verification'

    runServer.workingDir = 'run'

    //Add Log Listener
    this.logging.addStandardOutputListener(new StandardOutputListener() {
        @Override
        void onOutput(CharSequence line) {
            if (line.contains("For help, type")) {
                System.exit(0)
            }
        }
    })

    doFirst {
        runServer.args("nogui").exec()
    }
})